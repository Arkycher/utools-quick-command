# uTools å¿«æ·å‘½ä»¤å¼€å‘è§„èŒƒ

æœ¬é¡¹ç›®åŒ…å« uTools å¿«æ·å‘½ä»¤æ’ä»¶è„šæœ¬ï¼Œç¯å¢ƒé€‰æ‹© `quickcommand`ã€‚

---

## ğŸ“ æ–‡ä»¶ç»“æ„è§„èŒƒ

### æ–‡ä»¶å¤´éƒ¨æ³¨é‡Šï¼ˆå¿…é¡»ï¼‰
```javascript
// =====================================================
// è„šæœ¬åç§° - åŠŸèƒ½æè¿°
// æ–°å»ºå‘½ä»¤æ—¶ï¼šç¯å¢ƒé€‰ quickcommandï¼Œè¾“å‡ºé€‰ã€è¾“å‡ºç±»å‹ã€‘
// =====================================================
```

### è¾“å‡ºç±»å‹é€‰æ‹©
| ç±»å‹ | é€‚ç”¨åœºæ™¯ | ç¤ºä¾‹ |
|------|----------|------|
| `å¿½ç•¥è¾“å‡ºå¹¶éšè—` | ç®€å•å¤„ç†ã€åˆ—è¡¨é€‰æ‹© | pangu_spacing.js, topic_emoji_master.js |
| `å¿½ç•¥è¾“å‡ºä¸”ä¸éšè—` | éœ€è¦ä¿æŒç•Œé¢çš„æ“ä½œ | cursor_recent_projects.js |
| `æ˜¾ç¤ºhtml` | å¤æ‚ UI å±•ç¤º | content_optimizer.js |

---

## ğŸšª é€€å‡ºæ–¹å¼è§„èŒƒ

### 1. ç®€å•å¤„ç†å‹ï¼ˆæ— äº¤äº’åˆ—è¡¨ï¼‰
ç›´æ¥éšè—çª—å£ï¼š
```javascript
utools.hideMainWindow()
```

### 2. åˆ—è¡¨é€‰æ‹©å‹ï¼ˆæœ‰ showSelectListï¼‰âš ï¸ é‡è¦
**å¿…é¡»ä½¿ç”¨ç»„åˆé€€å‡º**ï¼Œå¦åˆ™å†æ¬¡æ‰“å¼€ä¼šç™½å±ï¼š
```javascript
function exitPlugin() {
  utools.hideMainWindow()  // éšè—çª—å£ï¼ˆä¸ç•™æœç´¢æ¡†ï¼‰
  utools.outPlugin()       // é€€å‡ºæ’ä»¶ï¼ˆé˜²æ­¢ç™½å±ï¼‰
}
```

### 3. éœ€è¦ä¿æŒæœç´¢æ¡†
åªé€€å‡ºæ’ä»¶ï¼š
```javascript
utools.outPlugin()
```

---

## ğŸ“¥ è¾“å…¥è·å–è§„èŒƒ

### ä»å…³é”®è¯è¾“å…¥è·å–
```javascript
const inputText = quickcommand.enterData?.payload || ''
```

### ä»å‰ªè´´æ¿è·å–
```javascript
const clipText = utools.getClipboardText?.() || ''
```

### ç»„åˆè·å–ï¼ˆä¼˜å…ˆå‰ªè´´æ¿ï¼‰
```javascript
const clipText = utools.getClipboardText?.() || ''
const inputText = clipText || quickcommand.enterData?.payload || ''
```

---

## ğŸ’¬ æ¶ˆæ¯æç¤ºè§„èŒƒ

### è¿›è¡Œä¸­/é”™è¯¯æç¤ºï¼ˆæ’ä»¶çª—å£å†…ï¼‰
```javascript
quickcommand.showMessageBox('æ­£åœ¨å¤„ç†...', 'info')
quickcommand.showMessageBox('å‘ç”Ÿé”™è¯¯', 'error')
```

### å®Œæˆé€šçŸ¥ï¼ˆå³ä¸‹è§’ç³»ç»Ÿé€šçŸ¥ï¼‰
```javascript
utools.showNotification('âœ… æ“ä½œå®Œæˆ')
```

---

## ğŸ“‹ åˆ—è¡¨é€‰æ‹©è§„èŒƒ

### ç®€å•å­—ç¬¦ä¸²æ•°ç»„
```javascript
quickcommand.showSelectList(['é€‰é¡¹1', 'é€‰é¡¹2', 'é€‰é¡¹3']).then(selected => {
  // selected å¯èƒ½æ˜¯ stringã€number æˆ– object
})
```

### å¯¹è±¡æ•°ç»„ï¼ˆå¸¦æè¿°ï¼‰
```javascript
const items = [
  { title: 'æ ‡é¢˜1', description: 'æè¿°1', idx: 0 },
  { title: 'æ ‡é¢˜2', description: 'æè¿°2', idx: 1 }
]
quickcommand.showSelectList(items, {
  placeholder: 'æœç´¢æç¤º',
  optionType: 'json'
}).then(selected => {
  // ä½¿ç”¨ selected.idx è·å–ç´¢å¼•
})
```

### è¿”å›å€¼å…¼å®¹å¤„ç†ï¼ˆå¿…é¡»ï¼‰
```javascript
quickcommand.showSelectList(items).then(selected => {
  if (selected === undefined || selected === null) return
  
  let result = ''
  if (typeof selected === 'number') {
    result = items[selected]
  } else if (typeof selected === 'string') {
    result = selected
  } else if (selected.title) {
    result = selected.title
  } else if (selected.id !== undefined) {
    result = items[selected.id]
  } else if (selected.idx !== undefined) {
    result = items[selected.idx]
  } else {
    result = String(selected)
  }
  
  // å¤„ç† result...
})
```

---

## ğŸ’¾ æ•°æ®å­˜å‚¨è§„èŒƒ

### æŒä¹…åŒ–å­˜å‚¨ï¼ˆå¿…é¡» try-catchï¼‰
```javascript
const STORAGE_KEY = 'my_data_key'

function getData() {
  try {
    return utools.dbStorage.getItem(STORAGE_KEY) || {}
  } catch (e) {
    return {}
  }
}

function setData(data) {
  try {
    utools.dbStorage.setItem(STORAGE_KEY, data)
  } catch (e) {}
}
```

---

## ğŸŒ HTTP è¯·æ±‚è§„èŒƒ

### Node.js ç¯å¢ƒï¼ˆå¿«æ·å‘½ä»¤ï¼‰
```javascript
const https = require('https')

const postData = JSON.stringify({ key: 'value' })

const options = {
  hostname: 'api.example.com',
  path: '/endpoint',
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
    'Authorization': `Bearer ${API_KEY}`,
    'Content-Length': Buffer.byteLength(postData)
  }
}

const req = https.request(options, (res) => {
  let data = ''
  res.on('data', chunk => { data += chunk })
  res.on('end', () => {
    if (res.statusCode !== 200) {
      utools.showNotification(`è¯·æ±‚å¤±è´¥ [${res.statusCode}]`)
      exitPlugin()
      return
    }
    try {
      const json = JSON.parse(data)
      // å¤„ç†å“åº”...
    } catch (e) {
      utools.showNotification(`è§£æå¤±è´¥: ${e.message}`)
      exitPlugin()
    }
  })
})

req.on('error', (e) => {
  utools.showNotification(`ç½‘ç»œé”™è¯¯: ${e.message}`)
  exitPlugin()
})
req.write(postData)
req.end()
```

### HTML è¾“å‡ºç¯å¢ƒï¼ˆæµè§ˆå™¨ fetchï¼‰
```javascript
fetch('https://api.example.com/endpoint', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
    'Authorization': 'Bearer ' + API_KEY
  },
  body: JSON.stringify({ key: 'value' })
})
.then(res => {
  if (!res.ok) throw new Error('è¯·æ±‚å¤±è´¥ [' + res.status + ']')
  return res.json()
})
.then(data => {
  // å¤„ç†å“åº”...
})
.catch(err => showError(err.message))
```

---

## ğŸ“¦ å¸¸ç”¨ Node.js æ¨¡å—

```javascript
const fs = require('fs')           // æ–‡ä»¶ç³»ç»Ÿ
const path = require('path')       // è·¯å¾„å¤„ç†
const os = require('os')           // ç³»ç»Ÿä¿¡æ¯
const https = require('https')     // HTTPS è¯·æ±‚
const { exec } = require('child_process')  // æ‰§è¡Œå‘½ä»¤
```

---

## âœ… å®Œæ•´æ¨¡æ¿ç¤ºä¾‹

### ç®€å•å¤„ç†å‹
```javascript
// =====================================================
// è„šæœ¬åç§° - åŠŸèƒ½æè¿°
// æ–°å»ºå‘½ä»¤æ—¶ï¼šç¯å¢ƒé€‰ quickcommandï¼Œè¾“å‡ºé€‰ã€å¿½ç•¥è¾“å‡ºå¹¶éšè—ã€‘
// =====================================================

const inputText = quickcommand.enterData?.payload || ''

if (!inputText.trim()) {
  utools.showNotification('è¯·è¾“å…¥æˆ–é€‰ä¸­æ–‡æœ¬')
} else {
  const result = processText(inputText)
  utools.copyText(result)
  utools.showNotification('âœ… å·²å¤åˆ¶')
}

utools.hideMainWindow()
```

### åˆ—è¡¨é€‰æ‹©å‹
```javascript
// =====================================================
// è„šæœ¬åç§° - åŠŸèƒ½æè¿°
// æ–°å»ºå‘½ä»¤æ—¶ï¼šç¯å¢ƒé€‰ quickcommandï¼Œè¾“å‡ºé€‰ã€å¿½ç•¥è¾“å‡ºå¹¶éšè—ã€‘
// =====================================================

function exitPlugin() {
  utools.hideMainWindow()
  utools.outPlugin()
}

const inputText = quickcommand.enterData?.payload || ''

if (!inputText.trim()) {
  utools.showNotification('è¯·è¾“å…¥æˆ–é€‰ä¸­æ–‡æœ¬')
  exitPlugin()
} else {
  quickcommand.showMessageBox('æ­£åœ¨å¤„ç†...', 'info')
  
  // å¼‚æ­¥è·å–æ•°æ®...
  const items = ['é€‰é¡¹1', 'é€‰é¡¹2', 'é€‰é¡¹3']
  
  quickcommand.showSelectList(items).then(selected => {
    if (selected !== undefined && selected !== null) {
      const result = typeof selected === 'string' ? selected : items[selected.id || selected]
      utools.copyText(result)
      utools.showNotification(`å·²å¤åˆ¶: ${result}`)
    }
    exitPlugin()
  })
}
```

---

## âš ï¸ å¸¸è§é—®é¢˜

### 1. å†æ¬¡æ‰“å¼€ç™½å±
**åŸå› **ï¼šä½¿ç”¨äº† `showSelectList` ä½†åªè°ƒç”¨ `hideMainWindow()`
**è§£å†³**ï¼šä½¿ç”¨ `exitPlugin()` ç»„åˆé€€å‡º

### 2. æœç´¢æ¡†æ²¡å…³æ‰
**åŸå› **ï¼šåªè°ƒç”¨äº† `outPlugin()` æ²¡æœ‰ `hideMainWindow()`
**è§£å†³**ï¼šå…ˆ `hideMainWindow()` å† `outPlugin()`

### 3. dbStorage æŠ¥é”™
**åŸå› **ï¼šæŸäº›ç¯å¢ƒä¸‹ API ä¸å¯ç”¨
**è§£å†³**ï¼šå¿…é¡»ç”¨ try-catch åŒ…è£¹

### 4. showSelectList è¿”å›å€¼ä¸ä¸€è‡´
**åŸå› **ï¼šä¸åŒæƒ…å†µè¿”å›æ ¼å¼ä¸åŒ
**è§£å†³**ï¼šä½¿ç”¨å…¼å®¹å¤„ç†ä»£ç ï¼ˆè§ä¸Šæ–‡ï¼‰
